# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Gigaviz Platform â€” Environment Variables
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Copy this file to .env.local and fill in the values.
#   cp .env.example .env.local
#
# Legend:
#   ğŸ”´ REQUIRED  â€” App won't start or core features break without it
#   ğŸŸ¡ RECOMMENDED â€” Important for production but optional in dev
#   âšª OPTIONAL  â€” Feature-specific or has sensible default
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


# â”€â”€ 1. Supabase (Core Database & Auth) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”´ Get these from: https://supabase.com â†’ Project Settings â†’ API
NEXT_PUBLIC_SUPABASE_URL=                      # Project URL (e.g. https://abc.supabase.co)
NEXT_PUBLIC_SUPABASE_ANON_KEY=                 # Anon/public key â€” safe for browser, RLS enforced
SUPABASE_SERVICE_ROLE_KEY=                     # Service role key â€” bypasses RLS, server-only!
SUPABASE_URL=                                  # âšª Alias of NEXT_PUBLIC_SUPABASE_URL (used by KB indexer scripts)
SUPABASE_DB_URL=                               # âšª Direct Postgres connection string (migrations/tooling only)
SUPABASE_DB_PASSWORD=                          # âšª DB password (scripts that build connection strings manually)
DEFAULT_WORKSPACE_ID=                          # âšª Fallback workspace ID for scripts/seeding


# â”€â”€ 2. App URLs & General â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”´ Base URL of the running application
APP_BASE_URL=http://localhost:3000             # Server-side base URL (auth redirects, emails, webhooks)
NEXT_PUBLIC_APP_URL=http://localhost:3000       # Client-side base URL (invite links, share URLs)
NEXT_PUBLIC_DEMO_UI=false                      # âšª Show demo/placeholder UI elements
NEXT_PUBLIC_INBOX_SLA_HOURS=24                 # âšª Default SLA target for inbox response time (hours)
NEXT_PUBLIC_SALES_WA=                          # âšª WhatsApp number shown on sales/contact pages


# â”€â”€ 3. Access Control & Feature Toggles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŸ¡ Comma-separated email addresses for access levels
ADMIN_EMAILS=                                  # Admin users (can access /admin/* routes)
ADMIN_EMAIL=                                   # âšª Singular alias fallback for ADMIN_EMAILS
GIGAVIZ_OWNER_EMAILS=                          # Platform owners (can access /ops/* and claim admin)
DEV_FULL_ACCESS_EMAILS=                        # Dev accounts that bypass entitlement checks
DEV_ADMIN_EMAILS=                              # Dev accounts shown in ops claim page
DEV_ADMIN_EMAIL=                               # âšª Singular alias fallback for DEV_ADMIN_EMAILS
OPS_ENABLED=0                                  # Enable /ops console (set to 1 in production)

# âšª Feature flags (boolean toggles)
SUPERVISOR_TAKEOVER_ENABLED=false              # Allow supervisors to take over inbox threads
SKILL_ROUTING_ENABLED=false                    # Enable skill-based routing for inbox
MERGE_ENABLED=false                            # Enable CRM contact merge feature
ENABLE_BILLING_TEST_MODE=false                 # Allow test billing/token operations
ENABLE_META_EVENTS_SEND=false                  # Enable sending CAPI events to Meta


# â”€â”€ 4. Email (Resend) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŸ¡ Get from: https://resend.com â†’ API Keys
RESEND_API_KEY=                                # Resend API key for transactional emails
RESEND_FROM_AUTH=                              # From address for auth emails (e.g. noreply@gigaviz.com)
RESEND_FROM_CONTACT=                           # From address for contact form (e.g. contact@gigaviz.com)
CONTACT_RECIPIENT_EMAIL=                       # Recipient for contact form submissions


# â”€â”€ 5. Analytics & SEO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NEXT_PUBLIC_GA_ID=                             # âšª Google Analytics 4 measurement ID (G-XXXXXXXXXX)
NEXT_PUBLIC_GOOGLE_SITE_VERIFICATION=          # âšª Google Search Console verification meta tag


# â”€â”€ 6. Sentry Error Monitoring â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŸ¡ Get from: https://sentry.io â†’ Project Settings
NEXT_PUBLIC_SENTRY_DSN=                        # Sentry DSN (client + server + edge)
SENTRY_ORG=                                    # Sentry organization slug (for source map uploads)
SENTRY_PROJECT=                                # Sentry project slug
SENTRY_AUTH_TOKEN=                             # Sentry auth token (CI source map uploads only)


# â”€â”€ 7. Logging â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
LOG_LEVEL=info                                 # âšª Log verbosity: debug | info | warn | error


# â”€â”€ 8. Meta OAuth / Graph API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”´ (for Meta Hub) Get from: https://developers.facebook.com â†’ App Dashboard
META_APP_ID=                                   # Facebook App ID (OAuth login, webhook verification)
META_APP_SECRET=                               # Facebook App Secret (OAuth token exchange, webhook signature)
META_BUSINESS_APP_ID=                          # âšª Business App ID (fallback for META_APP_ID in subscribed-apps)
META_OAUTH_REDIRECT_URI=https://gigaviz.com/api/meta/oauth/callback  # OAuth callback URL
META_GRAPH_API_VERSION=v21.0                   # Graph API version for all Meta services
META_GRAPH_VERSION=v21.0                       # âšª Alias for META_GRAPH_API_VERSION
WA_GRAPH_VERSION=v22.0                         # âšª WhatsApp-specific Graph API version (overrides META_GRAPH_VERSION)
META_SYSTEM_USER_TOKEN=                        # âšª System User token for server-to-server Graph API calls
META_WHATSAPP_ACCESS_TOKEN=                    # âšª Alias â€” WhatsApp access token for Graph API

# ğŸŸ¡ Client-side Meta SDK configuration
NEXT_PUBLIC_META_APP_ID=                       # Facebook App ID exposed to browser (Embedded Signup SDK)
NEXT_PUBLIC_META_CONFIG_ID=                    # WhatsApp Embedded Signup config ID
NEXT_PUBLIC_META_SOLUTION_ID=                  # WhatsApp Solution Partner ID


# â”€â”€ 9. Meta Hub Toggles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âšª Enable/disable individual Meta Hub channels
META_HUB_WA_ENABLED=true                      # WhatsApp channel
META_HUB_IG_ENABLED=false                      # Instagram channel
META_HUB_MS_ENABLED=false                      # Messenger channel
META_HUB_ADS_ENABLED=false                     # Ads Manager / CAPI
META_HUB_INSIGHTS_ENABLED=false                # Insights dashboard
META_HUB_WA_TEST_DRY_RUN=false                # Dry-run WhatsApp test sends (no actual delivery)
META_HUB_ALLOW_PENDING_TEST=false              # Allow testing templates in pending-approval status


# â”€â”€ 10. Webhook Verification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”´ (for Meta Hub) Token used to verify Meta webhook subscriptions
META_WEBHOOK_VERIFY_TOKEN=                     # Primary verify token (used by all Meta webhooks)
WA_WEBHOOK_VERIFY_TOKEN=                       # âšª Alias for META_WEBHOOK_VERIFY_TOKEN
WEBHOOK_VERIFY_TOKEN=                          # âšª Alias for META_WEBHOOK_VERIFY_TOKEN


# â”€â”€ 11. WhatsApp Cloud API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”´ (for WhatsApp messaging) Get from: Meta Business Suite â†’ WhatsApp
WA_ACCESS_TOKEN=                               # WhatsApp Cloud API access token (send messages)
WA_CLOUD_API_TOKEN=                            # âšª Alias for WA_ACCESS_TOKEN
WA_CLOUD_API_SYSTEM_USER_TOKEN=                # âšª System User token (longer-lived, recommended for production)
WHATSAPP_ACCESS_TOKEN=                         # âšª Legacy alias for WA_ACCESS_TOKEN
WA_WABA_ID=                                   # WhatsApp Business Account ID
WA_PHONE_NUMBER_ID=                            # WhatsApp phone number ID (sender)
WA_ADMIN_PHONE=                                # âšª Admin phone number for test/alert messages


# â”€â”€ 12. Attachments (Supabase Storage) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ATTACHMENTS_BUCKET=inbox-attachments           # âšª Supabase Storage bucket name for inbox attachments
ATTACHMENTS_SIGNED_URL_TTL=600                 # âšª Signed URL expiry in seconds (default: 10 minutes)


# â”€â”€ 13. Rate Limit & Worker Configuration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ENABLE_WA_SEND=false                           # Master switch: enable outbox worker to send WhatsApp messages
RATE_CAP_PER_MIN=20                            # âšª Max messages per minute per workspace
RATE_DELAY_MIN_MS=800                          # âšª Min delay between sends (ms)
RATE_DELAY_MAX_MS=2200                         # âšª Max delay between sends (ms)
WORKER_ID=                                     # âšª Unique worker instance ID (for multi-worker setups)
WORKER_BATCH_SIZE=20                           # âšª Messages to claim per poll cycle
WORKER_MAX_ATTEMPTS=5                          # âšª Max retry attempts before marking failed
WORKER_POLL_INTERVAL_MS=2000                   # âšª Poll interval in ms (default: 2 seconds)


# â”€â”€ 14. Cron Jobs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CRON_SECRET=                                   # ğŸŸ¡ Shared secret for /api/cron/* (generate: openssl rand -base64 32)
VERCEL_CRON_SECRET=                            # âšª Auto-set by Vercel (alternative to CRON_SECRET)


# â”€â”€ 15. AI / Helper Providers (server-only) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”´ (for Helper module) At least one LLM key required
OPENAI_API_KEY=                                # OpenAI key â€” used for embeddings + chat (required for RAG)
ANTHROPIC_API_KEY=                             # âšª Anthropic Claude key (alternative chat provider)
GEMINI_API_KEY=                                # âšª Google Gemini key (alternative chat provider)
OLLAMA_URL=http://127.0.0.1:11434             # âšª Local Ollama server URL (self-hosted LLM)
OLLAMA_MODEL=gemma3:4b                         # âšª Default Ollama model

# âšª NLP / Sentiment analysis (external service)
NLP_API_URL=                                   # NLP service endpoint
NLP_SENTIMENT_URL=                             # Sentiment analysis endpoint
NLP_API_KEY=                                   # NLP service API key
NLP_SENTIMENT_KEY=                             # Sentiment service API key

# âšª n8n workflow integration
N8N_WEBHOOK_URL=                               # n8n webhook trigger URL
N8N_SHARED_SECRET=                             # n8n shared secret for auth


# â”€â”€ 16. Knowledge Base / RAG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âšª Configuration for KB indexing (scripts/kb-index.ts)
KB_ALLOWED_DOMAINS=                            # Comma-separated domains to crawl
KB_SITEMAP_URLS=                               # Sitemap URLs to discover pages
KB_SEED_URLS=                                  # Starting URLs for web crawler
KB_MAX_PAGES_PER_RUN=200                       # Max pages to index per run
KB_USER_AGENT=GigavizBot/1.0                   # User-Agent string for crawler
KB_EMBED_PROVIDER=openai                       # Embedding provider: openai | ollama
KB_EMBED_MODEL=text-embedding-3-small          # Embedding model name
KB_EMBED_DIM=1536                              # Embedding vector dimensions
KB_CHUNK_MAX_CHARS=2200                        # Max characters per chunk
KB_CHUNK_OVERLAP_CHARS=200                     # Overlap between chunks
KB_BLOCKED_PATH_PREFIXES=/api,/auth,/admin,/dashboard,/settings,/billing,/workspace,/tokens
KB_BLOCKED_QUERY_KEYS=token,code,key,secret,session,auth


# â”€â”€ 17. Ops Alerting â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âšª Webhook URLs for operational alerts (health, impersonation, suspension)
OPS_SLACK_WEBHOOK_URL=                         # Slack Incoming Webhook URL
OPS_DISCORD_WEBHOOK_URL=                       # Discord Webhook URL
OPS_ALERT_WEBHOOK_URL=                         # Generic webhook URL (any service)


# â”€â”€ 18. Upstash Redis â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŸ¡ Get from: https://console.upstash.com â†’ Redis Database
UPSTASH_REDIS_REST_URL=                        # Upstash Redis REST URL (for rate limiting)
UPSTASH_REDIS_REST_TOKEN=                      # Upstash Redis REST token


# â”€â”€ 19. Midtrans (Payment Gateway â€” Indonesia) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŸ¡ Get from: https://dashboard.midtrans.com â†’ Settings â†’ Access Keys
MIDTRANS_SERVER_KEY=                           # Server key (SB-Mid-server-... for sandbox, Mid-server-... for prod)
MIDTRANS_CLIENT_KEY=                           # Client key (SB-Mid-client-... for sandbox, Mid-client-... for prod)
MIDTRANS_IS_PRODUCTION=false                   # Set to "true" for production (uses app.midtrans.com instead of sandbox)
NEXT_PUBLIC_MIDTRANS_CLIENT_KEY=               # Same as MIDTRANS_CLIENT_KEY (exposed for Snap.js in browser)
NEXT_PUBLIC_MIDTRANS_IS_PRODUCTION=false       # Same as MIDTRANS_IS_PRODUCTION (exposed for Snap.js URL)
NEXT_PUBLIC_MIDTRANS_ENABLED=                  # Set to "1" to enable Midtrans checkout buttons

# â”€â”€ 20. Xendit (Payment Gateway â€” International + SEA) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŸ¡ Get from: https://dashboard.xendit.co â†’ Settings â†’ API Keys
XENDIT_SECRET_KEY=                             # Secret API key (xnd_development_... or xnd_production_...)
XENDIT_WEBHOOK_TOKEN=                          # Webhook verification token (from Dashboard â†’ Settings â†’ Callbacks)
NEXT_PUBLIC_XENDIT_ENABLED=                    # Set to "1" to enable Xendit checkout buttons


# â”€â”€ 21. Scripts / Tooling (not needed at runtime) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âšª Used only by scripts in scripts/ folder
# AUDIT_BASE_URL=http://localhost:3000         # Base URL for audit/nav-url scanning script
# DATABASE_URL=                                # Raw Postgres URL for migration scripts


# â”€â”€ 21. Testing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âšª Only set in test environments
# SKIP_ENV_VALIDATION=true                     # Skip Zod env validation (CI/test only)


# â”€â”€ Legacy / unused (commented out for reference) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# WA_VERIFY_TOKEN=                             # Replaced by META_WEBHOOK_VERIFY_TOKEN
# META_BUSINESS_ID=                            # Not referenced in code
# BILLING_PROVIDER=manual
# XENDIT_SECRET_KEY=                           # Not used â€” using Midtrans instead
# KB_ADMIN_REINDEX_TOKEN=
# KB_INDEX_CRON_ENABLED=true
